SUBDIRS = Source 

export DEMETER_RELATIVE = ../../THIRDPARTYLIBS/demeter
export CHUNKLOD_RELATIVE = ../../THIRDPARTYLIBS/CSPChunkLod

export GDEBUGF = -g -Wall
export GCFLAGS = -fPIC -O2# -DSWIG_GLOBAL #-march=athon-tbird
export GLDOPTS = -shared -lswigpy -ldl
export GSWOPTS = -c -c++ -python -noexcept
export CXX = g++
export SWIG = swig 

.PHONY: all clean clean-deps swig default

default: all

all clean clean-deps: Makefile
	@for dir in $(SUBDIRS); do \
		$(MAKE) -C $${dir} $@ || exit 1; \
	done
	@$(MAKE) InputMaps

#default: 
#	@for dir in $(SUBDIRS); do \
#		$(MAKE) -C $${dir} $@ || exit 1; \
#	done

Makefile: Makefile.in configure.in acinclude.m4
	aclocal ; autoconf
	./configure

InputMaps: aircraft.hid gamescreen.hid


%.hid:
	@test -e Data/Input/$@ || \
	  ( cd Tools/HID && \
	    python map2hid Examples/$(@:%.hid=%.map) ../../Data/Input/$@ && \
	    echo "Default input map created for $@; see Tools/HID/README for details." \
	  )
	@test -e Data/Input/$@ || \
	    echo "Unable to create default input map for $@; see Tools/HID/README for details."


